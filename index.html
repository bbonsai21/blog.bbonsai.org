<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonsai Blog</title>
    <style>
        :root { --bg: #ffffff; --text: #1a1a1a; --accent: #777; --border: #eaeaea; --code-bg: #f5f5f5; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); color: var(--text); line-height: 1.7; margin: 0; }
        #container { max-width: 80%; margin: 60px auto; padding: 0 20px; }
        
        header { margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: baseline; }
        header a.logo { text-decoration: none; color: #0000FF; font-weight: 600; }
        
        .lang-picker { font-size: 0.8rem; }
        .lang-picker a { text-decoration: none; color: var(--accent); margin-left: 10px; padding: 2px 6px; border-radius: 3px; }
        .lang-picker a.active { color: #000; font-weight: bold; border: 1px solid var(--border); }

        .post-link { display: block; margin-bottom: 15px; text-decoration: none; color: var(--text); }
        .post-link:hover { color: var(--accent); }
        .date { color: var(--accent); font-size: 0.85rem; margin-right: 15px; font-variant-numeric: tabular-nums; }
        
        #content h1 { margin-top: 2rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem; }
        pre { background: var(--code-bg); padding: 15px; border-radius: 5px; overflow-x: auto; border: 1px solid var(--border); }
        code { font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace; font-size: 0.9rem; }
        
        footer { margin-top: 80px; font-size: 0.8rem; color: var(--accent); border-top: 1px solid var(--border); padding-top: 20px; }
    </style>
</head>
<body>

<div id="container">
    <header>
        <div> <a href="https://bbonsai.org" class="logo">Bonsai</a> journal </div>
        <div class="lang-picker" id="langPicker">
            <a href="?lang=en" id="btn-en">English</a>
        </div>
    </header>

    <div id="content">Loading...</div>

    <footer>Â© 2025-2035</footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script>
    const md = window.markdownit({ html: true, linkify: true, typographer: true });

    const posts = [
        {title: "My coding conventions", file: "posts/my-coding-conventions.md", date: "25/12/2025", lang: "en"},
        {title: "Hello, Internet!", file: "posts/website-functioning.md", date: "21/12/2025", lang: "en" },
    ];

    const contentDiv = document.getElementById('content');
    const urlParams = new URLSearchParams(window.location.search);
    const postFile = urlParams.get('post');
    const currentLang = urlParams.get('lang') || 'en';

    document.getElementById(`btn-${currentLang}`).classList.add('active');

    if (postFile) {
        fetch(postFile + '?t=' + new Date().getTime())
            .then(res => {
                if (!res.ok) throw new Error("File not found");
                return res.text();
            })
            .then(text => { 
                contentDiv.innerHTML = md.render(text); 
            })
            .catch(err => { 
                contentDiv.innerHTML = "<h1>Error</h1><p>Post not found.</p>"; 
            });
    } else {
        // Filter posts by selected language
        let html = "";
        const filteredPosts = posts.filter(p => p.lang === currentLang);

        filteredPosts.forEach(p => {
            html += `<a class="post-link" href="?post=${p.file}&lang=${currentLang}">
                        <span class="date">${p.date}</span> ${p.title}
                     </a>`;
        });
        
        contentDiv.innerHTML = html || `<p>No posts available in this language.</p>`;
    }
</script>

</body>
</html>
